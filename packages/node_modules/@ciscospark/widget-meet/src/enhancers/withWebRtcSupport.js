import React from 'react';
import classNames from 'classnames';
import {intlShape} from 'react-intl';
import {
  compose,
  branch,
  renderComponent
} from 'recompose';

import SparkLogo from '@ciscospark/react-component-spark-logo';

import messages from '../messages';
import styles from '../styles.css';

function NoWebRTCSupport({intl}) {
  return (
    <div className={classNames(styles.meetWidgetContainer, styles.noWebRtc, 'meet-widget-container')}>
      <div className={styles.noWebRtcLogo}><SparkLogo /></div>
      <div className={styles.noWebRtcMessage}>
        <p>{intl.formatMessage(messages.noWebRTCBrowserSupportMessage)}</p>
        <p>{intl.formatMessage(messages.useSupportedBrowserMessage)}</p>
      </div>
    </div>
  );
}

NoWebRTCSupport.propTypes = {
  // eslint-disable-next-line react/no-typos
  intl: intlShape.isRequired
};

const errorWhenNoSupport = (isNotSupported) =>
  branch(
    isNotSupported,
    renderComponent(NoWebRTCSupport)
  );

export default compose(
  errorWhenNoSupport(({media}) =>
    media.getIn(['webRTC', 'hasCheckedSupport']) &&
    !media.getIn(['webRTC', 'isSupported']))
);
