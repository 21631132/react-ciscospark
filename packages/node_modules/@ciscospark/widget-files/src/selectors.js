import {createSelector} from 'reselect';

const getConversation = (state) => state.conversation;

const getFilesWidgetProps = createSelector(
  [getConversation],
  (conversation) => {
    const fileShares = [];
    conversation
      .get('activities')
      .filter((activity) => activity.verb === 'share')
      .forEach((activity) => {
        if (activity.object.files && activity.object.files.items.length) {
          activity.object.files.items.forEach((fileItem) => {
            const fileShare = {
              actor: activity.actor,
              activityId: activity.id,
              item: fileItem
            };
            fileShares.push(fileShare);
          });
        }
      });

    return {fileShares};
  }
);

export default getFilesWidgetProps;
