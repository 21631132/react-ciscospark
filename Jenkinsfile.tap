#!groovy

pipeline {
  agent{
    label 'NODE_JS_BUILDER'
  }

  options {
    timeout(time: 1, unit: 'HOURS')
    timestamps()
    ansiColor('xterm')
  }

  stages {
    stage('Clean') {
      steps {
        sh 'rm -rf node_modules'
      }
    }

    stage('Install') {
      steps {
        withCredentials([
          string(credentialsId: 'NPM_TOKEN', variable: 'NPM_TOKEN')
        ]) {
          sh '''#!/bin/bash -ex
          rm -rf *
          '''
        }
      }
    }


  post {
    failure {
      echo "this failed in post"  
      //emailext body: 'Spark-js-sdk--react-widget--tap build number $BUILD_NUMBER has failed. For detailed information, please refer to $BUILD_URL', subject: 'ðŸš¨ðŸš¨ðŸš¨ Spark-js-sdk--react-widget--tap Failure ðŸš¨ðŸš¨ðŸš¨', to: 'spark-js-sdk-gating-pipeline-email.94d222a7@ciscospark.pagerduty.com'
    }
  }
}
